import{r as l,X as f,Y as x,s as E,a as g,j as e,L as C,U as h,H as o,B as p}from"./index-510343dd.js";import{u as j,T,C as y}from"./TransactionTypeSelect-54aa6bf4.js";import{T as I,a as m}from"./index-f376e980.js";import{F as i}from"./index-a67c42cc.js";import{I as v}from"./index-1757b794.js";import"./index-270e24b8.js";import"./useMergedState-c0927449.js";import"./KeyCode-6413d982.js";import"./Select-be08bc0c.js";var b={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"};const N=b;var S=function(t,r){return l.createElement(f,x(x({},t),{},{ref:r,icon:N}))};S.displayName="EditOutlined";const L=l.forwardRef(S),O=E.div`
  margin-bottom: 1em;

  .ant-tree .ant-tree-node-content-wrapper {
    cursor: default;
  }
`,w=E.span`
  color: ${({theme:s,active:t})=>t?s.text.primary:s.text.inactive};
`,F=E(L)`
  margin-left: 0.5em;
  cursor: pointer;
`,A=({showHidden:s,typeId:t})=>{const r=g(),{useGetTree:d}=j(),{isLoading:a,isError:c,data:u}=d({showHidden:!!s,typeId:t});return a?e.jsx(C,{}):c?e.jsx(e.Fragment,{children:"Error"}):e.jsx(e.Fragment,{children:e.jsx(O,{children:e.jsx(I,{treeData:u,selectable:!1,titleRender:n=>e.jsx("span",{children:e.jsxs(w,{active:!!n.isActive,children:[n.title,e.jsx(F,{onClick:()=>{r(`${h.SETTINGS.CATEGORIES}/${n.key}`)}})]})})})})})},P=({onFinish:s})=>{const{useCreate:t}=j(),r=t(),d=g(),[a]=i.useForm(),[c,u]=l.useState(o.EXPENSE);return e.jsxs("div",{children:[e.jsx("div",{children:"Новая категория"}),e.jsxs(i,{name:"basic",labelCol:{span:8},form:a,layout:"vertical",wrapperCol:{span:16},initialValues:{initialValue:0,name:"",type:{id:o.EXPENSE},order:1},onValuesChange:()=>{u(a.getFieldValue(["type","id"]))},onFinish:n=>{r.mutate(n),console.log("query.isSuccess",n),d(h.SETTINGS.CATEGORIES),s()},autoComplete:"off",children:[e.jsx(i.Item,{label:"Название",name:"name",rules:[{message:"Введите название категории",required:!0}],children:e.jsx(v,{})}),e.jsx(i.Item,{label:"Тип",name:["type","id"],rules:[{message:"Укажите тип категории",required:!0}],children:e.jsx(T,{hideReturns:!0})}),e.jsx(i.Item,{label:"Родительская категория",name:["parentCategory","id"],children:e.jsx(y,{typeId:c,allowClear:!0})}),e.jsx(i.Item,{wrapperCol:{offset:8,span:16},children:e.jsx(p,{type:"primary",htmlType:"submit",disabled:r.isLoading,children:"Сохранить"})})]}),r.isLoading&&e.jsx("div",{children:"Сохранение данных..."})]})},M=()=>{const[s,t]=l.useState(!1),[r,d]=l.useState(o.EXPENSE),[a,c]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Категории"}),e.jsxs(m,{defaultActiveKey:String(o.EXPENSE),onChange:u=>{d(parseInt(u))},children:[e.jsx(m.TabPane,{tab:"Расходы"},String(o.EXPENSE)),e.jsx(m.TabPane,{tab:"Доходы"},String(o.INCOME))]}),e.jsx(A,{showHidden:a,typeId:r}),!a&&e.jsx(p,{onClick:()=>{c(!0)},children:"Показать скрытые"}),e.jsx(p,{onClick:()=>{t(!0)},children:"Добавить"}),s&&e.jsx(P,{onFinish:()=>{t(!1)}})]})};export{M as CategoriesPage,M as default};
